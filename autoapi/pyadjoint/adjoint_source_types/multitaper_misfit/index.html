<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2022.12.07 -->
        <title>pyadjoint.adjoint_source_types.multitaper_misfit - Pyadjoint documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../../index.html"><div class="brand">Pyadjoint  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../../index.html">
  
  
  <span class="sidebar-brand-text">Pyadjoint  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">INTRODUCTION</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../example_dataset.html">Example Dataset</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">MISFIT FUNCTIONS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../waveform.html">Waveform Misfit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../convolution.html">Convolution Misfit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cctm.html">Cross Correlation Traveltime Misfit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../mtm.html">Multitaper Misfit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../exp_phase.html">Exponentiated Phase Misfit</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DOUBLE DIFFERENCE MISFIT</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../dd_waveform.html">Waveform Double Difference Misfit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dd_convolution.html">Convolution Double Difference Misfit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dd_cctm.html">Cross Correlation Traveltime Double Difference Misfit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dd_mtm.html">Double Difference Multitaper Misfit</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">MISCELLANEOUS</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../new_adjsrc.html">Add a New Adjoint Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../citations.html">Citations</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../../index.html">API Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="../../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyadjoint</span></code></a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current has-children"><a class="reference internal" href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyadjoint.adjoint_source_types</span></code></a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../cc_traveltime_misfit/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyadjoint.adjoint_source_types.cc_traveltime_misfit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../exponentiated_phase_misfit/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyadjoint.adjoint_source_types.exponentiated_phase_misfit</span></code></a></li>
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyadjoint.adjoint_source_types.multitaper_misfit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../waveform_misfit/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyadjoint.adjoint_source_types.waveform_misfit</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../tests/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyadjoint.tests</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tests/test_adjsrcs/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyadjoint.tests.test_adjsrcs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tests/test_config/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyadjoint.tests.test_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tests/test_utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyadjoint.tests.test_utils</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../adjoint_source/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyadjoint.adjoint_source</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../config/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyadjoint.config</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../main/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyadjoint.main</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../cctm/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cctm</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dpss/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dpss</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../signal/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">signal</span></code></a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="module-pyadjoint.adjoint_source_types.multitaper_misfit">
<span id="pyadjoint-adjoint-source-types-multitaper-misfit"></span><h1><a class="reference internal" href="#module-pyadjoint.adjoint_source_types.multitaper_misfit" title="pyadjoint.adjoint_source_types.multitaper_misfit"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyadjoint.adjoint_source_types.multitaper_misfit</span></code></a><a class="headerlink" href="#module-pyadjoint.adjoint_source_types.multitaper_misfit" title="Permalink to this heading"></a></h1>
<p>Multitaper based phase and amplitude misfit and adjoint source.</p>
<dl class="field-list simple">
<dt class="field-odd">authors</dt>
<dd class="field-odd"><p>adjTomo Dev Team (<a class="reference external" href="mailto:adjtomo&#37;&#52;&#48;gmail&#46;com">adjtomo<span>&#64;</span>gmail<span>&#46;</span>com</a>), 2022
Youyi Ruan (<a class="reference external" href="mailto:youyir&#37;&#52;&#48;princeton&#46;edu">youyir<span>&#64;</span>princeton<span>&#46;</span>edu</a>), 2016
Matthieu Lefebvre (<a class="reference external" href="mailto:ml15&#37;&#52;&#48;princeton&#46;edu">ml15<span>&#64;</span>princeton<span>&#46;</span>edu</a>), 2016
Yanhua O. Yuan (<a class="reference external" href="mailto:yanhuay&#37;&#52;&#48;princeton&#46;edu">yanhuay<span>&#64;</span>princeton<span>&#46;</span>edu</a>), 2015</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>BSD 3-Clause (“BSD New” or “BSD Simplified”)</p>
</dd>
</dl>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this heading"></a></h2>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this heading"></a></h3>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit" title="pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultitaperMisfit</span></code></a></p></td>
<td><p>A class to house the machinery of the multitaper misfit calculation. This is</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this heading"></a></h3>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.calculate_adjoint_source" title="pyadjoint.adjoint_source_types.multitaper_misfit.calculate_adjoint_source"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_adjoint_source</span></code></a>(observed, synthetic, config, ...)</p></td>
<td><p>Convenience wrapper function for MTM class to match the expected format</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyadjoint.adjoint_source_types.multitaper_misfit.</span></span><span class="sig-name descname"><span class="pre">MultitaperMisfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synthetic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">windows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synthetic_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">windows_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/pyadjoint/adjoint_source_types/multitaper_misfit.html#MultitaperMisfit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit" title="Permalink to this definition"></a></dt>
<dd><p>A class to house the machinery of the multitaper misfit calculation. This is
done with a class rather than a function to reduce the amount of unnecessary
parameter passing between functions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_adjoint_source">
<span class="sig-name descname"><span class="pre">calculate_adjoint_source</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/pyadjoint/adjoint_source_types/multitaper_misfit.html#MultitaperMisfit.calculate_adjoint_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_adjoint_source" title="Permalink to this definition"></a></dt>
<dd><p>Main processing function to calculate adjoint source for MTM.
The logic here is that the function will perform a series of checks/
calculations to check if MTM is valid for each given window. If
any check/calculation fails, it will fall back to CCTM misfit for the
given window.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_dd_adjoint_source">
<span class="sig-name descname"><span class="pre">calculate_dd_adjoint_source</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/pyadjoint/adjoint_source_types/multitaper_misfit.html#MultitaperMisfit.calculate_dd_adjoint_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_dd_adjoint_source" title="Permalink to this definition"></a></dt>
<dd><p>Process double difference adjoint source. Requires second set of
waveforms and windows.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>amplitude measurement stuff has been mostly left in the function
(i.e., commented out) even it is not used, so that hopefully it is
easier for someone in the future to implement it if they want.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a>, np.array, np.array, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a>)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(misfit_sum_p, fp, fp_2, win_stats) == (
total phase misfit  for the measurement,
adjoint source for first data-synthetic pair,
adjoint source for second data-synthetic pair,
measurement information dictionary
)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_mt_adjsrc">
<span class="sig-name descname"><span class="pre">calculate_mt_adjsrc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tapers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfreq_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfreq_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau_mtm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dlna_mtm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wp_w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wq_w</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/pyadjoint/adjoint_source_types/multitaper_misfit.html#MultitaperMisfit.calculate_mt_adjsrc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_mt_adjsrc" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the adjoint source for a multitaper measurement, which
tapers synthetics in various windowed frequency-dependent tapers and
scales them by phase dependent travel time measurements (which
incorporate the observed data).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>np.array</em>) – synthetic data array</p></li>
<li><p><strong>tapers</strong> (<em>np.array</em>) – array of DPPS windows shaped (num_taper, nlen_w)</p></li>
<li><p><strong>nfreq_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – minimum frequency for suitable MTM measurement</p></li>
<li><p><strong>nfreq_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – maximum frequency for suitable MTM measurement</p></li>
<li><p><strong>dtau_mtm</strong> (<em>np.array</em>) – phase dependent travel time measurements from mtm</p></li>
<li><p><strong>dlna_mtm</strong> (<em>np.array</em>) – phase dependent amplitude anomaly</p></li>
<li><p><strong>wp_w</strong> (<em>np.array</em>) – phase-misfit error weighted frequency domain taper</p></li>
<li><p><strong>wq_w</strong> (<em>np.array</em>) – amplitude-misfit error weighted frequency domain taper</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_dd_mt_adjsrc">
<span class="sig-name descname"><span class="pre">calculate_dd_mt_adjsrc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tapers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfreq_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfreq_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau_mtm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dlna_mtm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wp_w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wq_w</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/pyadjoint/adjoint_source_types/multitaper_misfit.html#MultitaperMisfit.calculate_dd_mt_adjsrc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_dd_mt_adjsrc" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the double difference adjoint source for multitaper
measurement. Almost the same as <cite>calculate_mt_adjsrc</cite> but only addresses
phase misfit and requres a second set of synthetics <cite>s_2</cite> which is
processed in the same way as the first set <cite>s</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>np.array</em>) – synthetic data array</p></li>
<li><p><strong>s_2</strong> (<em>np.array</em>) – optional 2nd set of synthetics for double difference
measurements only. This will change the output</p></li>
<li><p><strong>tapers</strong> (<em>np.array</em>) – array of DPPS windows shaped (num_taper, nlen_w)</p></li>
<li><p><strong>nfreq_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – minimum frequency for suitable MTM measurement</p></li>
<li><p><strong>nfreq_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – maximum frequency for suitable MTM measurement</p></li>
<li><p><strong>df</strong> (<em>floats</em>) – step length of frequency bins for FFT</p></li>
<li><p><strong>dtau_mtm</strong> (<em>np.array</em>) – phase dependent travel time measurements from mtm</p></li>
<li><p><strong>dlna_mtm</strong> (<em>np.array</em>) – phase dependent amplitude anomaly</p></li>
<li><p><strong>wp_w</strong> (<em>np.array</em>) – phase-misfit error weighted frequency domain taper</p></li>
<li><p><strong>wq_w</strong> (<em>np.array</em>) – amplitude-misfit error weighted frequency domain taper</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_freq_domain_taper">
<span class="sig-name descname"><span class="pre">calculate_freq_domain_taper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nfreq_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfreq_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau_mtm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dlna_mtm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_dt_cc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_dlna_cc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_dtau_mt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_dlna_mt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/pyadjoint/adjoint_source_types/multitaper_misfit.html#MultitaperMisfit.calculate_freq_domain_taper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_freq_domain_taper" title="Permalink to this definition"></a></dt>
<dd><p>Calculates frequency domain taper weighted by misfit (either CC or MTM)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Frequency-domain tapers are based on adjusted frequency band and
error estimation. They are not one of the filtering processes that
needs to be applied to the adjoint source but rather a frequency
domain weighting function for adjoint source and misfit function.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nfreq_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – minimum frequency for suitable MTM measurement</p></li>
<li><p><strong>nfreq_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – maximum frequency for suitable MTM measurement</p></li>
<li><p><strong>df</strong> (<em>floats</em>) – step length of frequency bins for FFT</p></li>
<li><p><strong>dtau_mtm</strong> (<em>np.array</em>) – phase dependent travel time measurements from mtm</p></li>
<li><p><strong>dlna_mtm</strong> (<em>np.array</em>) – phase dependent amplitude anomaly</p></li>
<li><p><strong>err_dt_cc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – cross correlation time shift error</p></li>
<li><p><strong>err_dlna_cc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – cross correlation amplitude anomaly error</p></li>
<li><p><strong>err_dtau_mt</strong> (<em>np.array</em>) – phase-dependent timeshift error</p></li>
<li><p><strong>err_dlna_mt</strong> (<em>np.array</em>) – phase-dependent amplitude error</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_multitaper">
<span class="sig-name descname"><span class="pre">calculate_multitaper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tapers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfreq_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfreq_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc_tshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc_dlna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/pyadjoint/adjoint_source_types/multitaper_misfit.html#MultitaperMisfit.calculate_multitaper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_multitaper" title="Permalink to this definition"></a></dt>
<dd><p>Measure phase-dependent time shifts and amplitude anomalies using
the multitaper method</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Formerly <cite>mt_measure</cite>. Renamed for additional clarity and to match
the CCTM function names</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>np.array</em>) – observed data array</p></li>
<li><p><strong>s</strong> (<em>np.array</em>) – synthetic data array</p></li>
<li><p><strong>tapers</strong> (<em>np.array</em>) – array of DPPS windows shaped (num_taper, nlen_w)</p></li>
<li><p><strong>wvec</strong> (<em>np.array</em>) – angular frequency array generated from Discrete Fourier
Transform sample frequencies</p></li>
<li><p><strong>nfreq_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – minimum frequency for suitable MTM measurement</p></li>
<li><p><strong>nfreq_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – maximum frequency for suitable MTM measurement</p></li>
<li><p><strong>cc_tshift</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – cross correlation time shift</p></li>
<li><p><strong>cc_dlna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – amplitude anomaly from cross correlation</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)">tuple</a> of np.array</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(phi_w, abs_w, dtau_w, dlna_w);
(frequency dependent phase anomaly,
phase dependent amplitude anomaly,
phase dependent cross-correlation time shift,
phase dependent cross-correlation amplitude anomaly)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_mt_error">
<span class="sig-name descname"><span class="pre">calculate_mt_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tapers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfreq_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfreq_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc_tshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc_dlna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_mtm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abs_mtm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau_mtm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dlna_mtm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/pyadjoint/adjoint_source_types/multitaper_misfit.html#MultitaperMisfit.calculate_mt_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_mt_error" title="Permalink to this definition"></a></dt>
<dd><p>Calculate multitaper error with Jackknife MT estimates.</p>
<p>The jackknife estimator of a parameter is found by systematically
leaving out each observation from a dataset and calculating the
parameter estimate over the remaining observations and then aggregating
these calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>np.array</em>) – observed data array</p></li>
<li><p><strong>s</strong> (<em>np.array</em>) – synthetic data array</p></li>
<li><p><strong>tapers</strong> (<em>np.array</em>) – array of DPPS windows shaped (num_taper, nlen_w)</p></li>
<li><p><strong>wvec</strong> (<em>np.array</em>) – angular frequency array generated from Discrete Fourier
Transform sample frequencies</p></li>
<li><p><strong>nfreq_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – minimum frequency for suitable MTM measurement</p></li>
<li><p><strong>nfreq_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – maximum frequency for suitable MTM measurement</p></li>
<li><p><strong>cc_tshift</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – cross correlation time shift</p></li>
<li><p><strong>cc_dlna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – amplitude anomaly from cross correlation</p></li>
<li><p><strong>phi_mtm</strong> (<em>np.array</em>) – frequency dependent phase anomaly</p></li>
<li><p><strong>abs_mtm</strong> (<em>np.array</em>) – phase dependent amplitude anomaly</p></li>
<li><p><strong>dtau_mtm</strong> (<em>np.array</em>) – phase dependent cross-correlation time shift</p></li>
<li><p><strong>dlna_mtm</strong> (<em>np.array</em>) – phase dependent cross-correlation amplitude anomaly)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)">tuple</a> of np.array</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(err_phi, err_abs, err_dtau, err_dlna),
(error in frequency dependent phase anomaly,
error in phase dependent amplitude anomaly,
error in phase dependent cross-correlation time shift,
error in phase dependent cross-correlation amplitude anomaly)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_freq_limits">
<span class="sig-name descname"><span class="pre">calculate_freq_limits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/pyadjoint/adjoint_source_types/multitaper_misfit.html#MultitaperMisfit.calculate_freq_limits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_freq_limits" title="Permalink to this definition"></a></dt>
<dd><p>Determine if a given window is suitable for multitaper measurements.
If so, finds the maximum frequency range for the measurement using a
spectrum of tapered synthetic waveforms</p>
<p>First check if the window is suitable for mtm measurements, then
find the maximum frequency point for measurement using the spectrum of
tapered synthetics.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>formerly <cite>frequency_limit</cite>. renamed to be more descriptive. also
split off earlier cycle check from this function into
<cite>check_sufficient_number_of_wavelengths</cite></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – step length of frequency bins for FFT</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>:return (float, float, bool);</dt><dd><p>(minimumum frequency, maximum frequency, continue with MTM?)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.prepare_data_for_mtm">
<span class="sig-name descname"><span class="pre">prepare_data_for_mtm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dlna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/pyadjoint/adjoint_source_types/multitaper_misfit.html#MultitaperMisfit.prepare_data_for_mtm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.prepare_data_for_mtm" title="Permalink to this definition"></a></dt>
<dd><p>Re-window observed data to center on the optimal time shift, and
scale by amplitude anomaly to get best matching waveforms for MTM</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.check_time_series_acceptability">
<span class="sig-name descname"><span class="pre">check_time_series_acceptability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cc_tshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlen_w</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/pyadjoint/adjoint_source_types/multitaper_misfit.html#MultitaperMisfit.check_time_series_acceptability"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.check_time_series_acceptability" title="Permalink to this definition"></a></dt>
<dd><p>Checking acceptability of the time series characteristics for MTM</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cc_tshift</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – time shift in unit [s]</p></li>
<li><p><strong>nlen_w</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – window length in samples</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if time series OK for MTM, False if fall back to CC</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.check_mtm_time_shift_acceptability">
<span class="sig-name descname"><span class="pre">check_mtm_time_shift_acceptability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nfreq_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfreq_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc_tshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtau_mtm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_dtau_mt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/pyadjoint/adjoint_source_types/multitaper_misfit.html#MultitaperMisfit.check_mtm_time_shift_acceptability"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.check_mtm_time_shift_acceptability" title="Permalink to this definition"></a></dt>
<dd><p>Check MTM time shift measurements to see if they are within allowable
bounds set by the config. If any of the phases used in MTM do not
meet criteria, we will fall back to CC measurement.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>formerly <cite>mt_measure_select</cite>, renamed for clarity</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nfreq_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – maximum in frequency domain</p></li>
<li><p><strong>nfreq_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – minimum in frequency domain</p></li>
<li><p><strong>df</strong> (<em>floats</em>) – step length of frequency bins for FFT</p></li>
<li><p><strong>cc_tshift</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – c.c. time shift</p></li>
<li><p><strong>dtau_mtm</strong> (<em>np.array</em>) – phase dependent travel time measurements from mtm</p></li>
<li><p><strong>sigma_dtau_mt</strong> (<em>np.array</em>) – phase-dependent error of multitaper measurement</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>flag for whether any of the MTM phases failed check</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.rewindow">
<span class="sig-name descname"><span class="pre">rewindow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/pyadjoint/adjoint_source_types/multitaper_misfit.html#MultitaperMisfit.rewindow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.rewindow" title="Permalink to this definition"></a></dt>
<dd><p>Align data in a window according to a given time shift. Will not fully
shift if shifted window hits bounds of the data array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.array</em>) – full data array to cut with shifted window</p></li>
<li><p><strong>left_sample</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – left window border</p></li>
<li><p><strong>right_sample</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – right window border</p></li>
<li><p><strong>shift</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – overall time shift in units of samples</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit._search_frequency_limit">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_search_frequency_limit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_search</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfreq_limit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">water_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/pyadjoint/adjoint_source_types/multitaper_misfit.html#MultitaperMisfit._search_frequency_limit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit._search_frequency_limit" title="Permalink to this definition"></a></dt>
<dd><p>Search valid frequency range of spectra. If the spectra larger than
10 * <cite>water_threshold</cite> it will trigger the search again, works like the
heating thermostat.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>is_search</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – Logic switch</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – index of spectra</p></li>
<li><p><strong>nfreq_limit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – index of freqency limit searched</p></li>
<li><p><strong>spectra</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – spectra of signal</p></li>
<li><p><strong>water_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – optional triggering value to stop the search,
if not given, defaults to Config value</p></li>
<li><p><strong>c</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – constant scaling factor for water threshold.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyadjoint.adjoint_source_types.multitaper_misfit.calculate_adjoint_source">
<span class="sig-prename descclassname"><span class="pre">pyadjoint.adjoint_source_types.multitaper_misfit.</span></span><span class="sig-name descname"><span class="pre">calculate_adjoint_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synthetic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">windows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synthetic_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">windows_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/pyadjoint/adjoint_source_types/multitaper_misfit.html#calculate_adjoint_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyadjoint.adjoint_source_types.multitaper_misfit.calculate_adjoint_source" title="Permalink to this definition"></a></dt>
<dd><p>Convenience wrapper function for MTM class to match the expected format
of Pyadjoint. Contains the logic for what to return to User.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observed</strong> (<em>obspy.core.trace.Trace</em>) – observed waveform to calculate adjoint source</p></li>
<li><p><strong>synthetic</strong> (<em>obspy.core.trace.Trace</em>) – synthetic waveform to calculate adjoint source</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="../../config/index.html#pyadjoint.config.ConfigCCTraveltime" title="pyadjoint.config.ConfigCCTraveltime"><em>pyadjoint.config.ConfigCCTraveltime</em></a>) – Config class with parameters to control processing</p></li>
<li><p><strong>windows</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em> of </em><em>tuples</em>) – [(left, right),…] representing left and right window
borders to be used to calculate misfit and adjoint sources</p></li>
<li><p><strong>observed_2</strong> (<em>obspy.core.trace.Trace</em>) – second observed waveform to calculate adjoint sources
from station pairs</p></li>
<li><p><strong>synthetic_2</strong> (<em>obspy.core.trace.Trace</em>) – second synthetic waveform to calculate adjoint sources
from station pairs</p></li>
<li><p><strong>windows_2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em> of </em><em>tuples</em>) – [(left, right),…] representing left and right window
borders to be tapered in units of seconds since first sample in data
array. Used to window <cite>observed_2</cite> and <cite>synthetic_2</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, adjTomo
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyadjoint.adjoint_source_types.multitaper_misfit</span></code></a><ul>
<li><a class="reference internal" href="#module-contents">Module Contents</a><ul>
<li><a class="reference internal" href="#classes">Classes</a></li>
<li><a class="reference internal" href="#functions">Functions</a><ul>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit"><code class="docutils literal notranslate"><span class="pre">MultitaperMisfit</span></code></a><ul>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_adjoint_source"><code class="docutils literal notranslate"><span class="pre">MultitaperMisfit.calculate_adjoint_source()</span></code></a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_dd_adjoint_source"><code class="docutils literal notranslate"><span class="pre">MultitaperMisfit.calculate_dd_adjoint_source()</span></code></a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_mt_adjsrc"><code class="docutils literal notranslate"><span class="pre">MultitaperMisfit.calculate_mt_adjsrc()</span></code></a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_dd_mt_adjsrc"><code class="docutils literal notranslate"><span class="pre">MultitaperMisfit.calculate_dd_mt_adjsrc()</span></code></a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_freq_domain_taper"><code class="docutils literal notranslate"><span class="pre">MultitaperMisfit.calculate_freq_domain_taper()</span></code></a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_multitaper"><code class="docutils literal notranslate"><span class="pre">MultitaperMisfit.calculate_multitaper()</span></code></a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_mt_error"><code class="docutils literal notranslate"><span class="pre">MultitaperMisfit.calculate_mt_error()</span></code></a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_freq_limits"><code class="docutils literal notranslate"><span class="pre">MultitaperMisfit.calculate_freq_limits()</span></code></a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.prepare_data_for_mtm"><code class="docutils literal notranslate"><span class="pre">MultitaperMisfit.prepare_data_for_mtm()</span></code></a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.check_time_series_acceptability"><code class="docutils literal notranslate"><span class="pre">MultitaperMisfit.check_time_series_acceptability()</span></code></a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.check_mtm_time_shift_acceptability"><code class="docutils literal notranslate"><span class="pre">MultitaperMisfit.check_mtm_time_shift_acceptability()</span></code></a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.rewindow"><code class="docutils literal notranslate"><span class="pre">MultitaperMisfit.rewindow()</span></code></a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit._search_frequency_limit"><code class="docutils literal notranslate"><span class="pre">MultitaperMisfit._search_frequency_limit()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.calculate_adjoint_source"><code class="docutils literal notranslate"><span class="pre">calculate_adjoint_source()</span></code></a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit">MultitaperMisfit</a><ul>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_adjoint_source">calculate_adjoint_source</a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_dd_adjoint_source">calculate_dd_adjoint_source</a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_mt_adjsrc">calculate_mt_adjsrc</a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_dd_mt_adjsrc">calculate_dd_mt_adjsrc</a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_freq_domain_taper">calculate_freq_domain_taper</a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_multitaper">calculate_multitaper</a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_mt_error">calculate_mt_error</a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.calculate_freq_limits">calculate_freq_limits</a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.prepare_data_for_mtm">prepare_data_for_mtm</a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.check_time_series_acceptability">check_time_series_acceptability</a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.check_mtm_time_shift_acceptability">check_mtm_time_shift_acceptability</a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit.rewindow">rewindow</a></li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.MultitaperMisfit._search_frequency_limit">_search_frequency_limit</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyadjoint.adjoint_source_types.multitaper_misfit.calculate_adjoint_source">calculate_adjoint_source</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>